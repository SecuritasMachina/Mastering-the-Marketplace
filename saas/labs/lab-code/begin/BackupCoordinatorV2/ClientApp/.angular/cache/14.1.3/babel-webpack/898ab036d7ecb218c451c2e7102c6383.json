{"ast":null,"code":"import _asyncToGenerator from \"C:/data/source/Mastering-the-Marketplace/saas/labs/lab-code/begin/BackupCoordinatorV2/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { environment } from '../../../environments/environment';\nimport { GlobalConstModule } from '../../Common/global-const/global-const.module';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"ngx-toastr\";\nimport * as i4 from \"@angular/common\";\n\nfunction DirListingComponent_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"em\");\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction DirListingComponent_table_3_tr_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function DirListingComponent_table_3_tr_12_Template_button_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const item_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      item_r3.disabled = true;\n      return i0.ɵɵresetView(ctx_r4.restoreFile(item_r3));\n    });\n    i0.ɵɵtext(3, \"Restore\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"date\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", item_r3.disabled);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r3.FileName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 4, item_r3.length));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(11, 6, item_r3.FileDate, \"medium\"));\n  }\n}\n\nfunction DirListingComponent_table_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 3)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"Action\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"FileName\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Size\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Date\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"tbody\");\n    i0.ɵɵtemplate(12, DirListingComponent_table_3_tr_12_Template, 12, 9, \"tr\", 4);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.dirListingDTO);\n  }\n}\n\nexport class DirListingComponent {\n  //public restoreInProgress: boolean | undefined;\n  // const options = new RequestOptions({ headers: this.headers });\n  constructor(http, _Activatedroute, toastr) {\n    this._Activatedroute = _Activatedroute;\n    this.toastr = toastr;\n    this.dirListingDTO = [];\n    this.genericMsg = {};\n    this.headers = new Headers({\n      'Accept': 'application/json',\n      'enctype': 'multipart/form-data'\n    });\n    this.intervalID = [];\n    this.timerCount = 0;\n    this.tmp = [];\n    this._http = http;\n    console.info('environment.appServerURL', environment.appServerURL);\n  }\n\n  ngOnInit() {\n    this._guid = this._Activatedroute.snapshot.paramMap.get(\"guid\");\n    console.info(\"DirListingComponent GlobalConstModule.guid1\", GlobalConstModule.guid);\n    console.log(\"this._guid\", this._guid);\n\n    this._http.get(environment.appServerURL + '/api/v3/getCache/dirListing-' + this._guid).subscribe(result => {\n      this.genericMsg.msg = result.msg;\n      this.genericMsg.guid = result.guid;\n      var tmp1 = JSON.parse(this.genericMsg.msg);\n      tmp1.fileDTOs.forEach((obj, index) => {\n        var fileDTO = {};\n        fileDTO.FileName = obj.FileName;\n        fileDTO.length = obj.length;\n        fileDTO.FileDate = obj.FileDate;\n        fileDTO.disabled = false;\n        this.dirListingDTO.push(fileDTO);\n      });\n      console.info(' this.dirListingDTO', this.dirListingDTO);\n    }, error => console.error(error));\n  }\n\n  CheckBackupStatus(pRestoreFileName, pTimerCount) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var pGuid = _this._guid; //throw new Error('Function not implemented.');\n\n      console.info(' pRestoreFileName', pRestoreFileName); //this.httpCall(\"POST\", pRestoreFileName)\n\n      _this._http.get(environment.appServerURL + \"/api/v3/getCache/\" + encodeURI(pRestoreFileName + \"-BACKUPFINISHED-\" + pGuid)).subscribe(result => {\n        console.log(\"getCache response:\", result);\n        clearInterval(_this.tmp[pTimerCount]); //setTimeout(this.tmp[pTimerCount]);\n\n        _this.dirListingDTO.forEach((obj, index) => {\n          if (pRestoreFileName == obj.FileName) {\n            obj.disabled = false;\n          }\n        });\n\n        _this.toastr.success(pRestoreFileName + ' restored', 'Restore Status');\n\n        _this._http.get(environment.appServerURL + \"/api/v3/deleteCache/\" + encodeURI(pRestoreFileName + \"-BACKUPFINISHED-\" + pGuid)).subscribe(result => {\n          console.log(\"deleteCache response:\", result);\n        });\n      });\n    })();\n  }\n\n  restoreFile(pItem) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      console.info('restoreFile.pRestoreFileName', pItem.FileName); //pItem.disabled = true;\n\n      const response = yield fetch(environment.appServerURL + \"/api/v2/requestRestore/\" + _this2._guid, {\n        method: 'POST',\n        body: JSON.stringify({\n          backupName: pItem.FileName,\n          customerGUID: _this2._guid\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json'\n        }\n      });\n\n      _this2.toastr.success(pItem.FileName + ' submitted for restoration', 'Restore Status');\n\n      if (!response.ok) {\n        throw new Error(`Error! status: ${response.status}`);\n      }\n\n      _this2.timerCount++;\n      _this2.tmp[_this2.timerCount] = setInterval(() => {\n        _this2.CheckBackupStatus(pItem.FileName, _this2.timerCount);\n      }, 10 * 1000);\n    })();\n  }\n\n}\n\nDirListingComponent.ɵfac = function DirListingComponent_Factory(t) {\n  return new (t || DirListingComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.ToastrService));\n};\n\nDirListingComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DirListingComponent,\n  selectors: [[\"app-dir-listing\"]],\n  decls: 4,\n  vars: 3,\n  consts: [[\"id\", \"tableLabel\"], [4, \"ngIf\"], [\"class\", \"table table-striped\", \"aria-labelledby\", \"tableLabel\", 4, \"ngIf\"], [\"aria-labelledby\", \"tableLabel\", 1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"], [1, \"pure-button\", \"pure-button-primary\", 3, \"disabled\", \"click\"]],\n  template: function DirListingComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\", 0);\n      i0.ɵɵtext(1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(2, DirListingComponent_p_2_Template, 3, 0, \"p\", 1);\n      i0.ɵɵtemplate(3, DirListingComponent_table_3_Template, 13, 1, \"table\", 2);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\"OffSite Directory Listing length:\", ctx.dirListingDTO.length, \"\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.dirListingDTO);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.dirListingDTO);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i4.DecimalPipe, i4.DatePipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJkaXItbGlzdGluZy5jb21wb25lbnQuY3NzIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["environment","GlobalConstModule","i0","item_r3","DirListingComponent","constructor","http","_Activatedroute","toastr","Headers","_http","console","info","appServerURL","ngOnInit","_guid","snapshot","paramMap","get","guid","log","subscribe","result","genericMsg","msg","tmp1","JSON","parse","fileDTOs","forEach","obj","index","fileDTO","FileName","length","FileDate","disabled","dirListingDTO","push","error","CheckBackupStatus","pRestoreFileName","pTimerCount","pGuid","encodeURI","clearInterval","tmp","success","restoreFile","pItem","response","fetch","method","body","stringify","backupName","customerGUID","headers","Accept","ok","Error","status","timerCount","setInterval","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\data\\source\\Mastering-the-Marketplace\\saas\\labs\\lab-code\\begin\\BackupCoordinatorV2\\ClientApp\\src\\app\\Components\\dir-listing\\dir-listing.component.ts","C:\\data\\source\\Mastering-the-Marketplace\\saas\\labs\\lab-code\\begin\\BackupCoordinatorV2\\ClientApp\\src\\app\\Components\\dir-listing\\dir-listing.component.html"],"sourcesContent":["import { Component, OnInit, Inject } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { environment } from '../../../environments/environment';\r\nimport { ActivatedRoute } from '@angular/router'\r\nimport { GlobalConstModule } from '../../Common/global-const/global-const.module';\r\nimport { NotificationService } from '../../Services/notification.service';\r\n//import { NavMenuComponent } from '../../nav-menu/nav-menu.component';\r\nimport { ToastrService } from 'ngx-toastr';\r\n@Component({\r\n  selector: 'app-dir-listing',\r\n  templateUrl: './dir-listing.component.html',\r\n  styleUrls: ['./dir-listing.component.css']\r\n})\r\nexport class DirListingComponent implements OnInit {\r\n\r\n  public dirListingDTO: DirListingDTO[] = [];\r\n  public genericMsg = {} as GenericMsg2;\r\n  private headers = new Headers({\r\n    'Accept': 'application/json',\r\n    'enctype': 'multipart/form-data'\r\n  });\r\n\r\n  public _guid: string | null | undefined;\r\n  _http: HttpClient;\r\n  private intervalID: any[] = [];\r\n  private timerCount = 0;\r\n  private tmp:any = [];\r\n  //public restoreInProgress: boolean | undefined;\r\n  // const options = new RequestOptions({ headers: this.headers });\r\n\r\n  constructor(http: HttpClient, private _Activatedroute: ActivatedRoute, private toastr: ToastrService) {\r\n\r\n    this._http = http;\r\n    console.info('environment.appServerURL', environment.appServerURL);\r\n\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this._guid = this._Activatedroute.snapshot.paramMap.get(\"guid\");\r\n    console.info(\"DirListingComponent GlobalConstModule.guid1\", GlobalConstModule.guid);\r\n    console.log(\"this._guid\", this._guid);\r\n    this._http.get<GenericMsg>(environment.appServerURL + '/api/v3/getCache/dirListing-' + this._guid).subscribe(result => {\r\n\r\n      this.genericMsg.msg = result.msg;\r\n      this.genericMsg.guid = result.guid;\r\n\r\n\r\n      var tmp1 = JSON.parse(this.genericMsg.msg);\r\n      tmp1.fileDTOs.forEach((obj: any, index: any) => {\r\n\r\n        var fileDTO = {} as DirListingDTO;\r\n        fileDTO.FileName = obj.FileName;\r\n        fileDTO.length = obj.length;\r\n        fileDTO.FileDate = obj.FileDate;\r\n        fileDTO.disabled = false;\r\n        this.dirListingDTO.push(fileDTO);\r\n\r\n      });\r\n\r\n      console.info(' this.dirListingDTO', this.dirListingDTO);\r\n\r\n    }, (error: any) => console.error(error));\r\n\r\n  }\r\n  async CheckBackupStatus(pRestoreFileName: string, pTimerCount: number) {\r\n    var pGuid = this._guid;\r\n    //throw new Error('Function not implemented.');\r\n    console.info(' pRestoreFileName', pRestoreFileName);\r\n    //this.httpCall(\"POST\", pRestoreFileName)\r\n    this._http.get<GenericMsg>(environment.appServerURL + \"/api/v3/getCache/\" + encodeURI(pRestoreFileName + \"-BACKUPFINISHED-\" + pGuid)).subscribe(result => {\r\n      console.log(\"getCache response:\", result);\r\n\r\n      clearInterval(this.tmp[pTimerCount]);\r\n      //setTimeout(this.tmp[pTimerCount]);\r\n      this.dirListingDTO.forEach((obj: DirListingDTO, index: any) => {\r\n        if (pRestoreFileName == obj.FileName) {\r\n          obj.disabled = false;\r\n        }\r\n      });\r\n      this.toastr.success(pRestoreFileName + ' restored', 'Restore Status');\r\n      this._http.get<string>(environment.appServerURL + \"/api/v3/deleteCache/\" + encodeURI(pRestoreFileName + \"-BACKUPFINISHED-\" + pGuid)).subscribe(result => {\r\n        console.log(\"deleteCache response:\", result);\r\n      });\r\n    });\r\n\r\n\r\n  }\r\n  async restoreFile(pItem: DirListingDTO): Promise<void> {\r\n    console.info('restoreFile.pRestoreFileName', pItem.FileName);\r\n\r\n    //pItem.disabled = true;\r\n\r\n    const response = await fetch(environment.appServerURL + \"/api/v2/requestRestore/\" + this._guid, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        backupName: pItem.FileName,\r\n        customerGUID: this._guid,\r\n      }),\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        Accept: 'application/json',\r\n      },\r\n    });\r\n    this.toastr.success(pItem.FileName + ' submitted for restoration', 'Restore Status');\r\n    if (!response.ok) {\r\n      throw new Error(`Error! status: ${response.status}`);\r\n    }\r\n    this.timerCount++;\r\n    this.tmp[this.timerCount] = setInterval(() => {\r\n      this.CheckBackupStatus(pItem.FileName, this.timerCount);\r\n    }, 10 * 1000);\r\n  }\r\n}\r\ntype GenericMsg2 = {\r\n  msgType: string;\r\n  msg: string;\r\n  guid: string;\r\n}\r\ninterface GenericMsg {\r\n  msgType: string;\r\n  msg: string;\r\n  guid: string;\r\n}\r\ninterface DirListingDTO {\r\n  FileName: string;\r\n  length: number;\r\n  date: string;\r\n  FileDate: number;\r\n  disabled: boolean;\r\n}\r\n\r\n\r\n","<h1 id=\"tableLabel\">OffSite Directory Listing length:{{dirListingDTO.length}}</h1>\r\n\r\n\r\n\r\n<p *ngIf=\"!dirListingDTO\"><em>Loading...</em></p>\r\n\r\n<table class='table table-striped' aria-labelledby=\"tableLabel\" *ngIf=\"dirListingDTO\">\r\n  <thead>\r\n    <tr>\r\n      <th>Action</th>\r\n      <th>FileName</th>\r\n      <th>Size</th>\r\n      <th>Date</th>\r\n\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr *ngFor=\"let item of dirListingDTO\">\r\n      <td><button [disabled]=\"item.disabled\" class=\"pure-button pure-button-primary\" (click)='item.disabled=true;restoreFile(item)'>Restore</button></td>\r\n      <td>{{ item.FileName }}</td>\r\n      <td>{{ item.length | number }}</td>\r\n      <td>{{ item.FileDate | date:'medium' }}</td>\r\n\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n"]},"metadata":{},"sourceType":"module"}