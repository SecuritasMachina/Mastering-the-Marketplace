{"ast":null,"code":"import _asyncToGenerator from \"C:/data/source/Mastering-the-Marketplace/saas/labs/lab-code/begin/BackupCoordinatorV2/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\n\nfunction LogListComponent_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"em\");\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction LogListComponent_table_3_tr_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"a\", 5);\n    i0.ɵɵlistener(\"click\", function LogListComponent_table_3_tr_12_Template_a_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const fileDTO_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r4.view(fileDTO_r3.logTime));\n    });\n    i0.ɵɵtext(3, \"View\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const fileDTO_r3 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(fileDTO_r3.logTime);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(fileDTO_r3.msg);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(fileDTO_r3.date);\n  }\n}\n\nfunction LogListComponent_table_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 3)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"Action\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"FileName\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Size\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Date\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"tbody\");\n    i0.ɵɵtemplate(12, LogListComponent_table_3_tr_12_Template, 10, 3, \"tr\", 4);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.logMsg.msg);\n  }\n}\n\nexport class LogListComponent {\n  constructor(http, _Activatedroute) {\n    this._Activatedroute = _Activatedroute;\n    this.logMsg = {};\n    this._logMsg = [];\n    this._http = http;\n  }\n\n  ngOnInit() {\n    this._guid = this._Activatedroute.snapshot.paramMap.get(\"guid\");\n\n    this._http.get(environment.appServerURL + '/api/v3/getLogs/' + this._guid).subscribe(result => {\n      console.info('result', result);\n      this.logMsg.msg = result.msg; //this.dirListingDTO = Object.assign({}, tmp1.fileDTOs); \n      //console.info(' this.dirListingDTO', this.dirListingDTO);\n      // console.info(' this.dirListingDTO length', this.dirListingDTO.length);\n    }, error => console.error(error));\n\n    console.log(\"this._guid\", this._guid);\n  }\n\n  view(pRestoreFileName) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      console.info(' pRestoreFileName', pRestoreFileName); //this.httpCall(\"POST\", pRestoreFileName)\n\n      const response = yield fetch(environment.appServerURL + \"/api/v2/requestRestore\", {\n        method: 'POST',\n        body: JSON.stringify({\n          backupName: pRestoreFileName,\n          customerGUID: _this._guid\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`Error! status: ${response.status}`);\n      }\n    })();\n  }\n\n}\n\nLogListComponent.ɵfac = function LogListComponent_Factory(t) {\n  return new (t || LogListComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n};\n\nLogListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LogListComponent,\n  selectors: [[\"app-log-list\"]],\n  decls: 4,\n  vars: 3,\n  consts: [[\"id\", \"tableLabel\"], [4, \"ngIf\"], [\"class\", \"table table-striped\", \"aria-labelledby\", \"tableLabel\", 4, \"ngIf\"], [\"aria-labelledby\", \"tableLabel\", 1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"], [1, \"pure-button\", \"pure-button-primary\", 3, \"click\"]],\n  template: function LogListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\", 0);\n      i0.ɵɵtext(1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(2, LogListComponent_p_2_Template, 3, 0, \"p\", 1);\n      i0.ɵɵtemplate(3, LogListComponent_table_3_Template, 13, 1, \"table\", 2);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\"OffSite Directory Listing length:\", ctx.dirListingDTO.length, \"\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.logMsg.msg);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.logMsg.msg);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJsb2ctbGlzdC5jb21wb25lbnQuY3NzIn0= */\"]\n});","map":{"version":3,"mappings":";AAEA,SAASA,WAAT,QAA4B,mCAA5B;;;;;;;;ICEAC,0BAAuB,CAAvB,EAAuB,IAAvB;IAA2BA;IAAUA;;;;;;;;IAajCA,2BAAuC,CAAvC,EAAuC,IAAvC,EAAuC,CAAvC,EAAuC,GAAvC,EAAuC,CAAvC;IACiDA;MAAA;MAAA;MAAA;MAAA,OAASA,+CAAT;IAA8B,CAA9B;IAAgCA;IAAIA;IACnFA;IAAIA;IAAqBA;IACzBA;IAAIA;IAAiBA;IACrBA;IAAIA;IAAkBA;;;;;IAFlBA;IAAAA;IACAA;IAAAA;IACAA;IAAAA;;;;;;IAfVA,iCAAmF,CAAnF,EAAmF,OAAnF,EAAmF,CAAnF,EAAmF,IAAnF,EAAmF,CAAnF,EAAmF,IAAnF;IAGUA;IAAMA;IACVA;IAAIA;IAAQA;IACZA;IAAIA;IAAIA;IACRA;IAAIA;IAAIA;IAIZA;IACEA;IAOFA;;;;;IAP0BA;IAAAA;;;;ADP5B,OAAM,MAAOC,gBAAP,CAAuB;EAM3BC,YAAYC,IAAZ,EAAsCC,eAAtC,EAAqE;IAA/B;IAJ/B,cAAS,EAAT;IACA,eAAoB,EAApB;IAIL,KAAKC,KAAL,GAAaF,IAAb;EACD;;EAEDG,QAAQ;IACN,KAAKC,KAAL,GAAa,KAAKH,eAAL,CAAqBI,QAArB,CAA8BC,QAA9B,CAAuCC,GAAvC,CAA2C,MAA3C,CAAb;;IACA,KAAKL,KAAL,CAAWK,GAAX,CAAuBX,WAAW,CAACY,YAAZ,GAA2B,kBAA3B,GAAgD,KAAKJ,KAA5E,EAAmFK,SAAnF,CAA6FC,MAAM,IAAG;MACpGC,OAAO,CAACC,IAAR,CAAa,QAAb,EAAuBF,MAAvB;MACA,KAAKG,MAAL,CAAYC,GAAZ,GAAkBJ,MAAM,CAACI,GAAzB,CAFoG,CAIpG;MACA;MACA;IACD,CAPD,EAOIC,KAAD,IAAgBJ,OAAO,CAACI,KAAR,CAAcA,KAAd,CAPnB;;IAQJJ,OAAO,CAACK,GAAR,CAAY,YAAZ,EAA0B,KAAKZ,KAA/B;EACG;;EACKa,IAAI,CAACC,gBAAD,EAAyB;IAAA;;IAAA;MACjCP,OAAO,CAACC,IAAR,CAAa,mBAAb,EAAkCM,gBAAlC,EADiC,CAEjC;;MACA,MAAMC,QAAQ,SAASC,KAAK,CAACxB,WAAW,CAACY,YAAZ,GAA2B,wBAA5B,EAAsD;QAChFa,MAAM,EAAE,MADwE;QAEhFC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;UACnBC,UAAU,EAAEP,gBADO;UAEnBQ,YAAY,EAAE,KAAI,CAACtB;QAFA,CAAf,CAF0E;QAMhFuB,OAAO,EAAE;UACP,gBAAgB,kBADT;UAEPC,MAAM,EAAE;QAFD;MANuE,CAAtD,CAA5B;;MAYA,IAAI,CAACT,QAAQ,CAACU,EAAd,EAAkB;QAChB,MAAM,IAAIC,KAAJ,CAAU,kBAAkBX,QAAQ,CAACY,MAAM,EAA3C,CAAN;MACD;IAjBgC;EAkBlC;;AAxC0B;;;mBAAhBjC,kBAAgBD;AAAA;;;QAAhBC;EAAgBkC;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCV7BvC;MAAoBA;MAAyDA;MAI7EA;MAEAA;;;;MANoBA;MAAAA;MAIhBA;MAAAA;MAE6DA;MAAAA","names":["environment","i0","LogListComponent","constructor","http","_Activatedroute","_http","ngOnInit","_guid","snapshot","paramMap","get","appServerURL","subscribe","result","console","info","logMsg","msg","error","log","view","pRestoreFileName","response","fetch","method","body","JSON","stringify","backupName","customerGUID","headers","Accept","ok","Error","status","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\data\\source\\Mastering-the-Marketplace\\saas\\labs\\lab-code\\begin\\BackupCoordinatorV2\\ClientApp\\src\\app\\Components\\log-list\\log-list.component.ts","C:\\data\\source\\Mastering-the-Marketplace\\saas\\labs\\lab-code\\begin\\BackupCoordinatorV2\\ClientApp\\src\\app\\Components\\log-list\\log-list.component.html"],"sourcesContent":["import { Component, OnInit, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { environment } from '../../../environments/environment';\nimport { ActivatedRoute } from '@angular/router'\n\n@Component({\n  selector: 'app-log-list',\n  templateUrl: './log-list.component.html',\n  styleUrls: ['./log-list.component.css']\n})\nexport class LogListComponent implements OnInit {\n  _http: HttpClient;\n  public logMsg = {} as LogMsg;\n  public _logMsg: LogMsg[] = [];\n  public _guid:  string | null | undefined;\n\n  constructor(http: HttpClient, private _Activatedroute: ActivatedRoute) {\n    this._http = http;\n  }\n\n  ngOnInit(): void {\n    this._guid = this._Activatedroute.snapshot.paramMap.get(\"guid\");\n    this._http.get<LogMsg>(environment.appServerURL + '/api/v3/getLogs/' + this._guid).subscribe(result => {\n      console.info('result', result);\n      this.logMsg.msg = result.msg;\n      \n      //this.dirListingDTO = Object.assign({}, tmp1.fileDTOs); \n      //console.info(' this.dirListingDTO', this.dirListingDTO);\n      // console.info(' this.dirListingDTO length', this.dirListingDTO.length);\n    }, (error: any) => console.error(error));\nconsole.log(\"this._guid\", this._guid);\n  }\n  async view(pRestoreFileName: string): Promise<void> {\n    console.info(' pRestoreFileName', pRestoreFileName);\n    //this.httpCall(\"POST\", pRestoreFileName)\n    const response = await fetch(environment.appServerURL + \"/api/v2/requestRestore\", {\n      method: 'POST',\n      body: JSON.stringify({\n        backupName: pRestoreFileName,\n        customerGUID: this._guid,\n      }),\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Error! status: ${response.status}`);\n    }\n  }\n}\n}\ninterface LogMsg {\n  logTime: string;\n  msg: string;\n  id: string;\n}\n","<h1 id=\"tableLabel\">OffSite Directory Listing length:{{dirListingDTO.length}}</h1>\r\n\r\n\r\n\r\n<p *ngIf=\"!logMsg.msg\"><em>Loading...</em></p>\r\n\r\n<table class='table table-striped' aria-labelledby=\"tableLabel\" *ngIf=\"logMsg.msg\">\r\n  <thead>\r\n    <tr>\r\n      <th>Action</th>\r\n      <th>FileName</th>\r\n      <th>Size</th>\r\n      <th>Date</th>\r\n\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr *ngFor=\"let fileDTO of logMsg.msg\">\r\n      <td><a class=\"pure-button pure-button-primary\" (click)='view(fileDTO.logTime)'>View</a></td>\r\n      <td>{{ fileDTO.logTime }}</td>\r\n      <td>{{ fileDTO.msg }}</td>\r\n      <td>{{ fileDTO.date }}</td>\r\n\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n"]},"metadata":{},"sourceType":"module"}