{"ast":null,"code":"import _asyncToGenerator from \"C:/data/source/Mastering-the-Marketplace/saas/labs/lab-code/begin/BackupCoordinatorV2/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\n\nfunction LogListComponent_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"em\");\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction LogListComponent_table_3_tr_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelement(1, \"td\");\n    i0.ɵɵelementStart(2, \"td\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const fileDTO_r3 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(fileDTO_r3.logTime);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(fileDTO_r3.msg);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(fileDTO_r3.msg.length);\n  }\n}\n\nfunction LogListComponent_table_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 3)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"Action\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Time\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Msg\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Msg Length\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"tbody\");\n    i0.ɵɵtemplate(12, LogListComponent_table_3_tr_12_Template, 8, 3, \"tr\", 4);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1._logMsg);\n  }\n}\n\nexport class LogListComponent {\n  constructor(http, _Activatedroute) {\n    this._Activatedroute = _Activatedroute;\n    this.logMsg = {};\n    this._logMsg = [];\n    this._http = http;\n  }\n\n  ngOnInit() {\n    this._guid = this._Activatedroute.snapshot.paramMap.get(\"guid\");\n\n    this._http.get(environment.appServerURL + '/api/v3/getLogs/' + this._guid).subscribe(result => {\n      console.info('result', result);\n      this._logMsg = JSON.parse(result.msg);\n      console.info('this.logMsg.msg', this._logMsg); //this.dirListingDTO = Object.assign({}, tmp1.fileDTOs); \n      //console.info(' this.dirListingDTO', this.dirListingDTO);\n      // console.info(' this.dirListingDTO length', this.dirListingDTO.length);\n    }, error => console.error(error));\n\n    console.log(\"this._guid\", this._guid);\n  }\n\n  view(pRestoreFileName) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      console.info(' pRestoreFileName', pRestoreFileName); //this.httpCall(\"POST\", pRestoreFileName)\n\n      const response = yield fetch(environment.appServerURL + \"/api/v2/requestRestore\", {\n        method: 'POST',\n        body: JSON.stringify({\n          backupName: pRestoreFileName,\n          customerGUID: _this._guid\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`Error! status: ${response.status}`);\n      }\n    })();\n  }\n\n}\n\nLogListComponent.ɵfac = function LogListComponent_Factory(t) {\n  return new (t || LogListComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n};\n\nLogListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LogListComponent,\n  selectors: [[\"app-log-list\"]],\n  decls: 4,\n  vars: 3,\n  consts: [[\"id\", \"tableLabel\"], [4, \"ngIf\"], [\"class\", \"table table-striped\", \"aria-labelledby\", \"tableLabel\", 4, \"ngIf\"], [\"aria-labelledby\", \"tableLabel\", 1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"]],\n  template: function LogListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\", 0);\n      i0.ɵɵtext(1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(2, LogListComponent_p_2_Template, 3, 0, \"p\", 1);\n      i0.ɵɵtemplate(3, LogListComponent_table_3_Template, 13, 1, \"table\", 2);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\"OffSite Log Listing length:\", ctx._logMsg.length, \"\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx._logMsg);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx._logMsg);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJsb2ctbGlzdC5jb21wb25lbnQuY3NzIn0= */\"]\n});","map":{"version":3,"mappings":";AAEA,SAASA,WAAT,QAA4B,mCAA5B;;;;;;;;ICEAC,0BAAoB,CAApB,EAAoB,IAApB;IAAwBA;IAAUA;;;;;;IAa9BA;IACEA;IAEAA;IAAIA;IAAqBA;IACzBA;IAAIA;IAAiBA;IACrBA;IAAIA;IAAwBA;;;;;IAFxBA;IAAAA;IACAA;IAAAA;IACAA;IAAAA;;;;;;IAhBVA,iCAAgF,CAAhF,EAAgF,OAAhF,EAAgF,CAAhF,EAAgF,IAAhF,EAAgF,CAAhF,EAAgF,IAAhF;IAGUA;IAAMA;IACVA;IAAIA;IAAIA;IACRA;IAAIA;IAAGA;IACPA;IAAIA;IAAUA;IAIlBA;IACEA;IASFA;;;;;IAT0BA;IAAAA;;;;ADP5B,OAAM,MAAOC,gBAAP,CAAuB;EAM3BC,YAAYC,IAAZ,EAAsCC,eAAtC,EAAqE;IAA/B;IAJ/B,cAAS,EAAT;IACA,eAAoB,EAApB;IAIL,KAAKC,KAAL,GAAaF,IAAb;EACD;;EAEDG,QAAQ;IACN,KAAKC,KAAL,GAAa,KAAKH,eAAL,CAAqBI,QAArB,CAA8BC,QAA9B,CAAuCC,GAAvC,CAA2C,MAA3C,CAAb;;IACA,KAAKL,KAAL,CAAWK,GAAX,CAAuBX,WAAW,CAACY,YAAZ,GAA2B,kBAA3B,GAAgD,KAAKJ,KAA5E,EAAmFK,SAAnF,CAA6FC,MAAM,IAAG;MACpGC,OAAO,CAACC,IAAR,CAAa,QAAb,EAAuBF,MAAvB;MACA,KAAKG,OAAL,GAAeC,IAAI,CAACC,KAAL,CAAWL,MAAM,CAACM,GAAlB,CAAf;MAEAL,OAAO,CAACC,IAAR,CAAa,iBAAb,EAAgC,KAAKC,OAArC,EAJoG,CAMpG;MACA;MACA;IACD,CATD,EASII,KAAD,IAAgBN,OAAO,CAACM,KAAR,CAAcA,KAAd,CATnB;;IAUAN,OAAO,CAACO,GAAR,CAAY,YAAZ,EAA0B,KAAKd,KAA/B;EACD;;EACKe,IAAI,CAACC,gBAAD,EAAyB;IAAA;;IAAA;MACjCT,OAAO,CAACC,IAAR,CAAa,mBAAb,EAAkCQ,gBAAlC,EADiC,CAEjC;;MACA,MAAMC,QAAQ,SAASC,KAAK,CAAC1B,WAAW,CAACY,YAAZ,GAA2B,wBAA5B,EAAsD;QAChFe,MAAM,EAAE,MADwE;QAEhFC,IAAI,EAAEV,IAAI,CAACW,SAAL,CAAe;UACnBC,UAAU,EAAEN,gBADO;UAEnBO,YAAY,EAAE,KAAI,CAACvB;QAFA,CAAf,CAF0E;QAMhFwB,OAAO,EAAE;UACP,gBAAgB,kBADT;UAEPC,MAAM,EAAE;QAFD;MANuE,CAAtD,CAA5B;;MAYA,IAAI,CAACR,QAAQ,CAACS,EAAd,EAAkB;QAChB,MAAM,IAAIC,KAAJ,CAAU,kBAAkBV,QAAQ,CAACW,MAAM,EAA3C,CAAN;MACD;IAjBgC;EAkBlC;;AA1C0B;;;mBAAhBlC,kBAAgBD;AAAA;;;QAAhBC;EAAgBmC;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCV7BxC;MAAoBA;MAA6CA;MAIjEA;MAEAA;;;;MANoBA;MAAAA;MAIhBA;MAAAA;MAE6DA;MAAAA","names":["environment","i0","LogListComponent","constructor","http","_Activatedroute","_http","ngOnInit","_guid","snapshot","paramMap","get","appServerURL","subscribe","result","console","info","_logMsg","JSON","parse","msg","error","log","view","pRestoreFileName","response","fetch","method","body","stringify","backupName","customerGUID","headers","Accept","ok","Error","status","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\data\\source\\Mastering-the-Marketplace\\saas\\labs\\lab-code\\begin\\BackupCoordinatorV2\\ClientApp\\src\\app\\Components\\log-list\\log-list.component.ts","C:\\data\\source\\Mastering-the-Marketplace\\saas\\labs\\lab-code\\begin\\BackupCoordinatorV2\\ClientApp\\src\\app\\Components\\log-list\\log-list.component.html"],"sourcesContent":["import { Component, OnInit, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { environment } from '../../../environments/environment';\nimport { ActivatedRoute } from '@angular/router'\n\n@Component({\n  selector: 'app-log-list',\n  templateUrl: './log-list.component.html',\n  styleUrls: ['./log-list.component.css']\n})\nexport class LogListComponent implements OnInit {\n  _http: HttpClient;\n  public logMsg = {} as LogMsg;\n  public _logMsg: LogMsg[] = [];\n  public _guid: string | null | undefined;\n\n  constructor(http: HttpClient, private _Activatedroute: ActivatedRoute) {\n    this._http = http;\n  }\n\n  ngOnInit(): void {\n    this._guid = this._Activatedroute.snapshot.paramMap.get(\"guid\");\n    this._http.get<LogMsg>(environment.appServerURL + '/api/v3/getLogs/' + this._guid).subscribe(result => {\n      console.info('result', result);\n      this._logMsg = JSON.parse(result.msg);\n\n      console.info('this.logMsg.msg', this._logMsg);\n\n      //this.dirListingDTO = Object.assign({}, tmp1.fileDTOs); \n      //console.info(' this.dirListingDTO', this.dirListingDTO);\n      // console.info(' this.dirListingDTO length', this.dirListingDTO.length);\n    }, (error: any) => console.error(error));\n    console.log(\"this._guid\", this._guid);\n  }\n  async view(pRestoreFileName: string): Promise<void> {\n    console.info(' pRestoreFileName', pRestoreFileName);\n    //this.httpCall(\"POST\", pRestoreFileName)\n    const response = await fetch(environment.appServerURL + \"/api/v2/requestRestore\", {\n      method: 'POST',\n      body: JSON.stringify({\n        backupName: pRestoreFileName,\n        customerGUID: this._guid,\n      }),\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Error! status: ${response.status}`);\n    }\n  }\n}\n\ninterface LogMsg {\n  logTime: string;\n  msg: string;\n  id: string;\n}\n","<h1 id=\"tableLabel\">OffSite Log Listing length:{{_logMsg.length}}</h1>\r\n\r\n\r\n\r\n<p *ngIf=\"!_logMsg\"><em>Loading...</em></p>\r\n\r\n<table class='table table-striped' aria-labelledby=\"tableLabel\" *ngIf=\"_logMsg\">\r\n  <thead>\r\n    <tr>\r\n      <th>Action</th>\r\n      <th>Time</th>\r\n      <th>Msg</th>\r\n      <th>Msg Length</th>\r\n\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr *ngFor=\"let fileDTO of _logMsg\">\r\n      <td></td>\r\n      <!--<td><a class=\"pure-button pure-button-primary\" (click)='view(fileDTO.logTime)'>View</a></td>-->\r\n      <td>{{ fileDTO.logTime }}</td>\r\n      <td>{{ fileDTO.msg }}</td>\r\n      <td>{{ fileDTO.msg.length }}</td>\r\n\r\n\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n"]},"metadata":{},"sourceType":"module"}